# Github App Token

`github-app-token` action allows users to retrieve an access token for a Terrafirm GitHub App. This token can be used to authenticate and perform actions with other actions and workflows in the repository.

## Prerequisites

1. **Terrafirma GitHub App Installed**: [Install the Terrafirma GitHub App](https://github.com/apps/terrafirma-linos) for a user, repository or organization you want to interact with.
2. **API Token**: Once the installation completes, an API access token will be generated for you. This token is required as an input to this action. Store this token in your github actions secrets. API token is valid for 6 months and can be regenerated by reinstalling the app. If you uninstall the app, the API token will be invalidated.

## Usage

Add the `adelinosousa/terrafirma/actions/github-app-token` action to your workflow:

```yaml
uses: adelinosousa/terrafirma/actions/github-app-token@github-app-token-v1.0.0
id: github-app-token
with:
  api_token: ${{ secrets.TERRAFIRMA_ACCESS_TOKEN }}
```

Use the `access_token` in your workflow. Example, using [create repository action](https://github.com/adelinosousa/terrafirma/tree/main/actions/create-repository):

```yaml
name: "Create repository"
id: create_repository
uses: ./actions/create-repository
with:
  name: "test-repository"
  token: ${{ steps.github-app-token.outputs.access_token }}
  private: false
```

### Inputs

- `api_token`: **(required)** Your Terrafirma API access token.

### Outputs

- `access_token`: Terrafirma Github App access token. Masked for security.

## Troubleshooting

- **Invalid API Token**: Ensure the API token is provided in the `github-app-token` input. The token is only valid for 6 months. If you're still facing issues, reinstall the Terrafirma GitHub App to generate a new token.
- **Access Denied**: Ensure the Terrafirma GitHub App is installed for the user, repository or organization you want to interact with. Terrafirma GitHub App permissions can change, you may need to reinstall the app to get the necessary permissions.

## Contribute

See our [documentation](https://github.com/adelinosousa/terrafirma/blob/main/CONTRIBUTING.md) for details.
